"use client";

import Link from "next/link";
import React, { useRef, useState, useEffect, useCallback } from "react";
import { usePathname, useRouter } from "next/navigation";
import { useGSAP } from "@gsap/react";
import gsap from "gsap";

const Menu = () => {
  const pathname = usePathname();
  const router = useRouter();

  const menuLinks = [
    { path: "/", label: "Index", prevImg: "/assets/images/menu/hero.webp" },
    { path: "/about", label: "About", prevImg: "/assets/images/cartoon.png" },
    {
      path: "/gallery",
      label: "Gallery",
      prevImg: "/assets/images/menu/img-3.jpg",
    },
    {
      path: "/connect",
      label: "Connect",
      prevImg: "/assets/images/menu/img-4.jpg",
    },
  ];

  const containerRef = useRef(null);
  const navRef = useRef(null);
  const menuPreviewImgRef = useRef(null);
  const menuOpenTextRef = useRef(null);
  const menuCloseTextRef = useRef(null);

  const tl = useRef(null);

  const [isOpen, setIsOpen] = useState(false);
  const [useWhite, setUseWhite] = useState(false);

  /* ------------------------------------------------------------------
     adaptive nav color (brightness sampling)
  ------------------------------------------------------------------ */

  const parseRGB = (rgbStr) => {
    const m = rgbStr.match(/rgba?\((\d+),\s*(\d+),\s*(\d+)/i);
    if (!m) return { r: 255, g: 255, b: 255 };
    return { r: +m[1], g: +m[2], b: +m[3] };
  };

  const brightness = ({ r, g, b }) => 0.299 * r + 0.587 * g + 0.114 * b;

  const getEffectiveBgColor = (el) => {
    while (el && el !== document.documentElement) {
      const bg = getComputedStyle(el).backgroundColor;
      if (bg && bg !== "rgba(0, 0, 0, 0)" && bg !== "transparent") {
        return bg;
      }
      el = el.parentElement;
    }
    return "rgb(255,255,255)";
  };

  const sampleUnderNav = useCallback(() => {
    if (isOpen) {
      setUseWhite(true);
      return;
    }

    const nav = navRef.current;
    if (!nav) return;

    const rect = nav.getBoundingClientRect();
    const y = rect.top + rect.height / 2;

    const xs = [0.15, 0.35, 0.55, 0.75, 0.9].map(
      (p) => rect.left + rect.width * p,
    );

    const prev = nav.style.pointerEvents;
    nav.style.pointerEvents = "none";

    const values = xs.map((x) => {
      const el = document.elementFromPoint(x, y);
      const bg = getEffectiveBgColor(el || document.body);
      return brightness(parseRGB(bg));
    });

    nav.style.pointerEvents = prev;

    const avg = values.reduce((a, b) => a + b, 0) / values.length;

    setUseWhite(avg < 160);
  }, [isOpen]);

  // scroll + resize (rAF throttled)
  useEffect(() => {
    let raf = null;

    const onScroll = () => {
      if (raf) return;
      raf = requestAnimationFrame(() => {
        sampleUnderNav();
        raf = null;
      });
    };

    window.addEventListener("scroll", onScroll, { passive: true });
    window.addEventListener("resize", sampleUnderNav);

    return () => {
      window.removeEventListener("scroll", onScroll);
      window.removeEventListener("resize", sampleUnderNav);
      if (raf) cancelAnimationFrame(raf);
    };
  }, [sampleUnderNav]);

  // re-sample on route / menu
  useEffect(() => {
    const t = setTimeout(sampleUnderNav, 50);
    return () => clearTimeout(t);
  }, [pathname, isOpen, sampleUnderNav]);

  const textTone = `transition-colors duration-300 ${
    useWhite ? "text-white" : "text-black"
  }`;

  const fillTone = useWhite ? "#ffffff" : "#000000";

  /* ------------------------------------------------------------------
     menu navigation
  ------------------------------------------------------------------ */

  const handleNavClick = (e, path) => {
    e.preventDefault();
    if (!isOpen) return router.push(path);

    toggleMenu();
    router.push(path);
  };

  /* ------------------------------------------------------------------
     menu animation
  ------------------------------------------------------------------ */

  useGSAP(
    () => {
      gsap.set(".menu-overlay", {
        clipPath: "polygon(0% 0%, 100% 0%, 100% 0%, 0% 0%)",
      });

      gsap.set(".menu-links .link", { y: 75, opacity: 0 });

      tl.current = gsap
        .timeline({
          paused: true,
          onReverseComplete: () => {
            // menu ist jetzt WIRKLICH zu â†’ Farbe neu bestimmen
            requestAnimationFrame(() => {
              sampleUnderNav();
            });
          },
        })
        .to(".menu-overlay", {
          clipPath: "polygon(0% 0%, 100% 0%, 100% 100%, 0% 100%)",
          duration: 1.1,
          ease: "power4.inOut",
        })
        .to(
          ".menu-links .link",
          {
            y: 0,
            opacity: 1,
            duration: 1,
            stagger: 0.1,
            ease: "power4.out",
          },
          "-=0.75",
        );
    },
    { scope: containerRef },
  );

  /* ------------------------------------------------------------------
     image hover preview
  ------------------------------------------------------------------ */

  const cleanupImages = () => {
    const imgs = menuPreviewImgRef.current.querySelectorAll("img");
    if (imgs.length > 3) {
      for (let i = 0; i < imgs.length - 3; i++) imgs[i].remove();
    }
  };

  const resetPreviewImage = () => {
    menuPreviewImgRef.current.innerHTML = "";
    const img = document.createElement("img");
    img.src = "/assets/images/menu/sunset.JPG";
    menuPreviewImgRef.current.appendChild(img);
  };

  const handleLinkHover = useCallback(
    (src) => {
      if (!isOpen || !src) return;

      const imgs = menuPreviewImgRef.current.querySelectorAll("img");
      if (imgs.length && imgs[imgs.length - 1].src.endsWith(src)) return;

      const img = document.createElement("img");
      img.src = src;
      img.style.opacity = 0;
      img.style.transform = "scale(1.2) rotate(2deg)";

      menuPreviewImgRef.current.appendChild(img);
      cleanupImages();

      gsap.to(img, {
        opacity: 1,
        scale: 1,
        rotation: 0,
        duration: 1,
        ease: "power3.out",
      });
    },
    [isOpen],
  );

  /* ------------------------------------------------------------------
     menu toggle
  ------------------------------------------------------------------ */

  const toggleMenu = () => {
    if (isOpen) {
      tl.current.reverse();
      resetPreviewImage();

      gsap.to(menuCloseTextRef.current, {
        opacity: 0,
        y: 10,
        duration: 0.4,
        ease: "power2.out",
      });

      gsap.to(menuOpenTextRef.current, {
        opacity: 1,
        y: 0,
        delay: 0.2,
        duration: 0.4,
        ease: "power2.out",
      });
    } else {
      tl.current.play();

      gsap.to(menuOpenTextRef.current, {
        opacity: 0,
        y: -10,
        duration: 0.4,
        ease: "power2.out",
      });

      gsap.to(menuCloseTextRef.current, {
        opacity: 1,
        y: 0,
        delay: 0.2,
        duration: 0.4,
        ease: "power2.out",
      });
    }

    setIsOpen(!isOpen);
  };

  /* ------------------------------------------------------------------
     render
  ------------------------------------------------------------------ */

  return (
    <div ref={containerRef}>
      <nav
        ref={navRef}
        className="nav fixed top-0 left-0 w-full px-5 py-3 flex justify-between items-center z-50"
      >
        <div className="logo w-10">
          <Link href="/">
            <svg
              id="dr"
              xmlns="http://www.w3.org/2000/svg"
              viewBox="0 0 300 133.21"
              fill={`${fillTone}`}
              className="w-full h-auto block"
            >
              <path d="M137.41,45.55c0,8.75-1.28,17.38-3.83,25.88s-6.35,16.46-11.39,23.87c-5.04,7.42-11.12,13.94-18.22,19.59-7.11,5.65-15.19,10.12-24.24,13.39-9.05,3.29-18.98,4.92-29.8,4.92-1.82,0-4.23-.06-7.2-.19-2.98-.12-6.1-.21-9.39-.27-3.28-.07-6.5-.1-9.66-.1-2.8,0-5.68.03-8.65.1-2.98.06-5.78.12-8.39.18-2.61.07-4.83.16-6.65.27l.55-3.65c3.89-.24,6.95-.73,9.2-1.45,2.25-.73,4.03-2.19,5.38-4.38,1.33-2.19,2.55-5.47,3.64-9.84L42.65,23.49c1.09-3.89,1.64-6.95,1.64-9.2s-.91-3.86-2.74-4.83c-1.82-.97-4.98-1.52-9.48-1.64l.55-3.65c1.94.13,4.29.24,7.02.36,2.74.13,5.68.19,8.84.19h8.93c2.68-.12,5.71-.21,9.11-.27,3.4-.06,6.75-.12,10.03-.19,3.28-.06,6.07-.09,8.38-.09,17.38,0,30.46,3.49,39.28,10.48,8.8,6.99,13.21,17.29,13.21,30.89ZM48.48,129.93c8.87,0,16.86-1.61,23.97-4.84,7.1-3.22,13.39-7.71,18.87-13.48,5.47-5.77,10.02-12.42,13.67-19.96,3.64-7.53,6.38-15.65,8.2-24.33,1.82-8.68,2.73-17.59,2.73-26.7,0-10.93-2.8-19.19-8.38-24.78-5.59-5.58-14.71-8.38-27.34-8.38-3.52,0-6.26.42-8.19,1.28-1.95.85-3.53,2.37-4.74,4.55-1.22,2.19-2.43,5.47-3.65,9.84l-23.87,91.13c-.98,3.65-1.52,6.65-1.65,9.03-.12,2.37.58,4.07,2.1,5.1,1.52,1.03,4.29,1.55,8.29,1.55Z" />
              <path d="M151.92,133.07V2.49h21.51v130.58h-21.51ZM202.81,76.24h-35.33v-13.25h32.45c8.06,0,14.24-1.95,18.53-5.86,4.28-3.9,6.43-9.18,6.43-15.84s-2.15-11.74-6.43-15.65c-4.29-3.91-10.35-5.86-18.15-5.86h-32.83V2.49h33.41c14.08,0,25.28,3.36,33.61,10.09,8.32,6.72,12.48,15.91,12.48,27.55s-4,20.74-12,26.89c-8,6.14-18.72,9.22-32.16,9.22ZM230.46,133.07l-7.88-34.95c-1.15-4.99-2.66-8.77-4.52-11.33-1.85-2.56-4.31-4.29-7.39-5.18-3.07-.9-6.98-1.34-11.71-1.34h-27.84v-13.83h30.91c8.7,0,15.78.8,21.22,2.4,5.44,1.6,9.7,4.39,12.77,8.35,3.08,3.97,5.51,9.54,7.3,16.71l9.8,39.18h-22.66Z" />
              <path d="M278.82,41.53c-3.07,0-5.88-.52-8.46-1.57-2.57-1.05-4.81-2.49-6.72-4.34-1.9-1.85-3.38-4.03-4.42-6.55-1.05-2.53-1.57-5.28-1.57-8.26s.52-5.8,1.57-8.32c1.05-2.52,2.52-4.72,4.42-6.58,1.91-1.87,4.15-3.32,6.72-4.34,2.58-1.03,5.4-1.55,8.46-1.55s5.89.52,8.49,1.57c2.59,1.05,4.84,2.49,6.75,4.34,1.91,1.85,3.37,4.03,4.4,6.55,1.03,2.53,1.55,5.29,1.55,8.32s-.52,5.73-1.55,8.23c-1.03,2.5-2.49,4.69-4.4,6.56-1.9,1.87-4.16,3.32-6.75,4.37-2.6,1.05-5.43,1.57-8.49,1.57ZM278.82,38.95c2.65,0,5.07-.45,7.25-1.34,2.18-.89,4.1-2.17,5.74-3.81,1.64-1.64,2.91-3.57,3.81-5.77.9-2.2,1.34-4.61,1.34-7.22s-.44-4.98-1.34-7.2c-.89-2.22-2.17-4.16-3.81-5.8-1.64-1.64-3.56-2.92-5.74-3.84-2.18-.91-4.6-1.37-7.25-1.37s-5.03.46-7.23,1.37c-2.2.92-4.12,2.2-5.74,3.84-1.62,1.64-2.88,3.58-3.78,5.8-.9,2.23-1.34,4.62-1.34,7.2s.44,5.02,1.34,7.22c.89,2.21,2.15,4.13,3.78,5.77,1.62,1.64,3.54,2.91,5.74,3.81s4.61,1.34,7.23,1.34ZM290.02,16.59h-6.55c-.3-1.08-.84-1.94-1.62-2.55-.78-.61-1.76-.92-2.91-.92-1.68,0-2.97.68-3.86,2.04-.89,1.36-1.34,3.24-1.34,5.63s.45,4.25,1.34,5.6c.89,1.34,2.18,2.02,3.86,2.02,1.08,0,2.03-.3,2.83-.89.8-.6,1.36-1.41,1.66-2.41h6.55c-.6,2.84-1.87,4.94-3.83,6.3-1.97,1.37-4.29,2.05-6.98,2.05-3.7,0-6.61-1.13-8.74-3.39-2.13-2.26-3.19-5.36-3.19-9.27s1.05-7.03,3.16-9.33c2.11-2.29,5.01-3.44,8.71-3.44,2.69,0,5.05.72,7.09,2.16,2.03,1.44,3.31,3.57,3.83,6.41Z" />
            </svg>
          </Link>
        </div>
        <div className="w-30">
          <Link href="/">
            <svg
              id="logo"
              xmlns="http://www.w3.org/2000/svg"
              viewBox="0 0 800 112"
              fill={`${fillTone}`}
              className="w-full h-auto block"
            >
              <path d="M103.76,43.21c0,6.61-.96,13.12-2.89,19.54s-4.79,12.43-8.6,18.03c-3.81,5.6-8.39,10.53-13.76,14.79-5.37,4.27-11.47,7.64-18.31,10.11-6.84,2.48-14.33,3.72-22.5,3.72-1.38,0-3.19-.04-5.44-.14-2.25-.09-4.61-.16-7.09-.2-2.48-.05-4.91-.07-7.29-.07-2.11,0-4.29.02-6.53.07-2.25.04-4.36.09-6.33.13-1.97.05-3.65.12-5.02.21l.41-2.75c2.93-.18,5.25-.55,6.95-1.1,1.7-.55,3.05-1.65,4.06-3.3,1.01-1.65,1.93-4.13,2.75-7.43L32.2,26.56c.82-2.93,1.24-5.25,1.24-6.95s-.69-2.91-2.07-3.65c-1.37-.73-3.76-1.15-7.16-1.24l.41-2.75c1.47.1,3.24.18,5.3.27,2.07.1,4.29.14,6.67.14h6.74c2.02-.09,4.31-.16,6.88-.21,2.57-.04,5.1-.09,7.57-.14,2.48-.04,4.59-.07,6.33-.07,13.12,0,23,2.64,29.66,7.91,6.65,5.28,9.97,13.05,9.97,23.33ZM36.6,106.93c6.7,0,12.73-1.22,18.1-3.65,5.36-2.43,10.11-5.82,14.25-10.18,4.13-4.36,7.57-9.38,10.32-15.07,2.75-5.69,4.82-11.82,6.19-18.37,1.37-6.56,2.06-13.28,2.06-20.16,0-8.25-2.11-14.49-6.33-18.71-4.22-4.22-11.1-6.33-20.65-6.33-2.66,0-4.73.32-6.19.96-1.47.64-2.67,1.79-3.58,3.44-.92,1.65-1.84,4.13-2.75,7.43l-18.03,68.81c-.74,2.75-1.15,5.02-1.24,6.81-.09,1.79.44,3.07,1.58,3.85,1.15.78,3.24,1.17,6.26,1.17Z" />
              <path d="M120.96,105.97c2.02,0,4.27-1.19,6.74-3.58,2.48-2.39,5-5.67,7.57-9.84,2.56-4.17,4.96-9.01,7.16-14.51,2.2-5.5,4.04-11.38,5.5-17.62l-2.48,15c-3.12,8.71-6.31,15.71-9.56,20.99-3.26,5.27-6.59,9.08-9.98,11.42-3.4,2.34-6.88,3.51-10.46,3.51-4.59,0-8.03-1.53-10.32-4.61-2.3-3.07-3.44-7.13-3.44-12.18,0-4.59.76-9.5,2.27-14.73,1.51-5.23,3.62-10.41,6.33-15.55,2.71-5.13,5.8-9.77,9.29-13.9,3.49-4.13,7.25-7.45,11.29-9.98,4.03-2.52,8.07-3.79,12.11-3.79,3.12,0,5.53,1.44,7.22,4.33,1.7,2.89,2.09,7.09,1.17,12.59l-1.51.83c.64-4.31.39-7.78-.76-10.39-1.15-2.62-3.01-3.92-5.57-3.92-2.21,0-4.54,1.13-7.02,3.37-2.48,2.25-4.88,5.32-7.22,9.22-2.34,3.9-4.5,8.28-6.47,13.14-1.98,4.87-3.51,9.89-4.61,15.07-1.1,5.19-1.65,10.25-1.65,15.21,0,3.67.39,6.24,1.17,7.71.78,1.47,1.85,2.21,3.23,2.21ZM153.85,38.53c2.75-.09,5.41-.27,7.98-.55,2.57-.27,4.96-.73,7.16-1.38l-17.48,60.96c-.27,1.01-.53,2.13-.76,3.38-.23,1.24-.18,2.32.13,3.23.32.92,1.17,1.38,2.55,1.38,1.65,0,3.3-.9,4.96-2.68,1.65-1.79,3.3-5.21,4.96-10.25l1.93-5.64h2.62l-3.44,10.05c-1.29,3.76-2.84,6.65-4.68,8.67-1.84,2.02-3.79,3.47-5.85,4.34-2.07.87-4.06,1.3-5.99,1.3-4.04,0-6.88-1.29-8.53-3.85-1.19-2.02-1.58-4.47-1.17-7.36.41-2.89,1.04-5.89,1.86-9.02l13.76-52.57Z" />
              <path d="M236.69,59.59c-2.94-1.46-5.6-3.57-7.99-6.33-2.39-2.75-3.48-6.05-3.3-9.91.18-2.39.99-4.13,2.41-5.23,1.42-1.1,2.96-1.65,4.61-1.65,3.3,0,5.59,1.7,6.88,5.09,1.28,3.39,1.7,7.8,1.24,13.21-.55,5.33-1.56,10.67-3.03,16.03-1.47,5.37-3.42,10.48-5.85,15.35-2.43,4.86-5.37,9.19-8.81,13s-7.34,6.79-11.7,8.95c-4.36,2.15-9.2,3.23-14.52,3.23-4.5,0-7.98-.85-10.46-2.55-2.48-1.7-4.22-3.85-5.22-6.47-1.01-2.62-1.43-5.3-1.24-8.05.28-5.32,1.88-10.92,4.82-16.79,2.93-5.87,6.85-11.83,11.76-17.89,4.91-6.05,10.57-11.92,16.99-17.61-1.74.46-3.49,1.22-5.23,2.27-1.74,1.06-3.39,2.13-4.96,3.24-1.56,1.1-3.07,2.04-4.54,2.82-1.47.78-2.89,1.17-4.27,1.17-1.74,0-3.21-.53-4.4-1.58s-2.53-1.58-3.99-1.58-2.64.58-3.51,1.72c-.87,1.15-1.81,3.19-2.82,6.13l-1.38,4.68h-2.62l3.03-10.05c1.56-5.6,3.51-9.36,5.85-11.29,2.34-1.93,4.7-2.89,7.09-2.89,1.74,0,3.21.44,4.4,1.31,1.19.87,2.43,1.72,3.72,2.54,1.28.83,2.89,1.24,4.82,1.24s3.97-.3,5.85-.9c1.88-.6,3.65-1.58,5.3-2.96l1.38-2.61,2.89,1.37c-3.58,4.59-6.77,9.22-9.56,13.9-2.8,4.68-5.21,9.38-7.23,14.11-2.02,4.73-3.62,9.4-4.82,14.03-1.19,4.64-1.97,9.24-2.34,13.83-.36,4.87,0,8.37,1.1,10.53s2.7,3.24,4.82,3.24c4.04,0,7.78-1.05,11.22-3.16,3.44-2.11,6.53-4.89,9.29-8.33,2.75-3.44,5.13-7.25,7.16-11.42,2.02-4.17,3.62-8.33,4.82-12.45,1.19-4.13,1.97-7.89,2.34-11.29Z" />
              <path d="M262.84,50.23c1.74-5.32,1.14-7.98-1.79-7.98-2.02,0-3.81,1.03-5.36,3.1-1.56,2.07-3.17,5.34-4.82,9.84l-2.2,5.78h-2.62l3.58-10.18c1.38-3.76,3.03-6.65,4.96-8.67,1.93-2.02,4.01-3.44,6.26-4.27,2.25-.82,4.42-1.24,6.54-1.24,3.02,0,5.32.6,6.88,1.79,1.56,1.19,2.53,2.75,2.89,4.68.37,1.93.37,4.01,0,6.27-.36,2.25-.92,4.42-1.65,6.53l-14.59,41.83c-.91,2.57-1.19,4.54-.82,5.92.36,1.38,1.33,2.06,2.89,2.06,1.65,0,3.26-.89,4.82-2.68,1.56-1.79,3.3-5.2,5.23-10.25l2.2-5.64h2.62l-3.58,10.05c-1.28,3.67-2.89,6.51-4.82,8.53-1.93,2.02-3.97,3.47-6.12,4.34-2.16.87-4.34,1.3-6.54,1.3-3.94,0-6.72-.9-8.33-2.68-1.6-1.79-2.32-4.22-2.13-7.3.18-3.07.92-6.45,2.21-10.11l14.31-41.01ZM267.39,14.17c.36-2.93,1.65-5.32,3.85-7.16,2.2-1.83,4.72-2.75,7.57-2.75,2.66,0,4.75.85,6.27,2.55,1.51,1.7,2.08,3.78,1.72,6.26-.37,2.84-1.67,5.21-3.93,7.08-2.25,1.88-4.79,2.82-7.64,2.82-2.66,0-4.73-.85-6.19-2.54s-2.02-3.79-1.65-6.27Z" />
              <path d="M303.44,106.1c2.02,0,4.36-1.24,7.02-3.71,2.66-2.48,5.37-5.92,8.12-10.33,2.75-4.4,5.35-9.56,7.78-15.48,2.43-5.92,4.42-12.22,5.99-18.93l-2.07,14.87c-3.39,9.27-6.76,16.74-10.11,22.43-3.35,5.69-6.81,9.84-10.39,12.45-3.58,2.62-7.53,3.92-11.84,3.92-2.84,0-5.41-.67-7.71-1.99-2.3-1.33-4.09-3.35-5.37-6.06-1.28-2.7-1.93-6.21-1.93-10.53s.71-8.99,2.13-14.03c1.42-5.05,3.44-10.05,6.05-15,2.62-4.96,5.78-9.47,9.5-13.56,3.72-4.08,7.87-7.36,12.45-9.84,4.59-2.48,9.54-3.72,14.87-3.72,2.38,0,4.42.76,6.12,2.27,1.7,1.51,2.64,3.74,2.82,6.67l-1.1,2.75c-.36-3.02-1.19-5.2-2.48-6.53-1.29-1.33-2.84-1.99-4.68-1.99-3.12,0-6.19,1.15-9.22,3.44-3.03,2.3-5.83,5.39-8.39,9.29-2.57,3.9-4.84,8.24-6.81,13-1.97,4.77-3.51,9.7-4.61,14.79-1.1,5.09-1.65,9.98-1.65,14.66,0,3.76.46,6.56,1.38,8.39.91,1.84,2.29,2.75,4.13,2.75ZM334.95,97.71c-.64,2.11-.85,3.97-.62,5.57.23,1.61,1.22,2.41,2.96,2.41,1.65,0,3.23-.91,4.75-2.75,1.51-1.84,3.1-5.23,4.74-10.19l1.93-5.64h2.61l-3.3,10.05c-1.1,3.67-2.59,6.53-4.47,8.6-1.88,2.06-3.9,3.51-6.05,4.33-2.16.82-4.2,1.24-6.13,1.24-5.6,0-8.72-2.43-9.36-7.29-.37-1.56-.44-3.42-.21-5.58s.76-4.56,1.58-7.22l19.54-73.62c.83-3.12.69-5.41-.41-6.88-1.1-1.47-3.9-2.2-8.4-2.2l.83-2.89c5.59-.09,10.53-.62,14.79-1.58,4.27-.96,8.33-2.31,12.18-4.06l-26.97,97.71Z" />
              <path d="M402.23,109.3V10.7h16.24v98.6h-16.24ZM440.66,66.39h-26.68v-10.01h24.5c6.09,0,10.76-1.47,13.99-4.42,3.23-2.94,4.86-6.93,4.86-11.96s-1.62-8.87-4.86-11.82c-3.24-2.95-7.81-4.42-13.71-4.42h-24.79v-13.05h25.23c10.63,0,19.09,2.54,25.38,7.62,6.28,5.07,9.42,12.01,9.42,20.8s-3.02,15.66-9.06,20.3c-6.04,4.64-14.14,6.96-24.28,6.96ZM461.54,109.3l-5.95-26.39c-.87-3.77-2.01-6.62-3.41-8.55-1.4-1.93-3.26-3.24-5.58-3.91-2.32-.68-5.27-1.01-8.84-1.01h-21.02v-10.44h23.34c6.57,0,11.91.61,16.02,1.81,4.11,1.21,7.32,3.32,9.64,6.31,2.32,3,4.16,7.2,5.51,12.61l7.4,29.58h-17.11Z" />
              <path d="M496.48,109.3V10.7h16.24v98.6h-16.24Z" />
              <path d="M617.11,40h-16.97c-1.74-5.6-4.78-9.94-9.13-12.98-4.35-3.04-9.48-4.57-15.37-4.57s-11.12,1.52-15.37,4.57c-4.25,3.04-7.54,7.37-9.86,12.98-2.32,5.6-3.48,12.32-3.48,20.15s1.16,14.53,3.48,20.08c2.32,5.56,5.68,9.84,10.08,12.83,4.4,3,9.59,4.5,15.59,4.5,4.54,0,8.65-.94,12.32-2.83,3.67-1.88,6.67-4.81,8.99-8.77,2.32-3.96,3.68-9.09,4.06-15.37h7.98c0,9.28-1.52,16.92-4.57,22.91-3.04,5.99-7.18,10.44-12.4,13.34-5.22,2.9-11.17,4.35-17.84,4.35-8.99,0-16.8-2.05-23.42-6.16-6.63-4.11-11.75-9.98-15.37-17.62-3.63-7.63-5.44-16.72-5.44-27.26s1.83-19.65,5.51-27.33c3.68-7.68,8.92-13.61,15.73-17.76,6.81-4.16,14.96-6.24,24.43-6.24,6.57,0,12.68,1.16,18.34,3.48,5.65,2.32,10.46,5.82,14.43,10.51,3.96,4.69,6.71,10.42,8.27,17.19ZM616.96,109.3h-11.75l-3.77-38.71h-23.34v-12.61h38.86v51.33Z" />
              <path d="M636.25,109.3V10.7h16.24v98.6h-16.24ZM648,65.22v-13.2h55.53v13.2h-55.53ZM700.34,109.3V10.7h16.24v98.6h-16.24Z" />
              <path d="M734.85,109.3V10.7h16.24v98.6h-16.24Z" />
              <path d="M784.01,40.18c-2.32,0-4.44-.4-6.39-1.19-1.94-.79-3.63-1.88-5.08-3.28-1.44-1.4-2.55-3.05-3.34-4.95-.79-1.91-1.19-3.98-1.19-6.24s.4-4.38,1.19-6.29c.79-1.9,1.9-3.56,3.34-4.97,1.44-1.41,3.13-2.5,5.08-3.28,1.95-.78,4.08-1.17,6.39-1.17s4.45.4,6.41,1.19c1.96.79,3.66,1.88,5.1,3.28,1.44,1.4,2.55,3.05,3.32,4.95.78,1.91,1.17,4,1.17,6.29s-.39,4.33-1.17,6.22-1.88,3.54-3.32,4.95c-1.44,1.41-3.14,2.51-5.1,3.3-1.96.79-4.1,1.19-6.41,1.19ZM784.01,38.23c2,0,3.83-.34,5.48-1.02,1.65-.68,3.1-1.64,4.34-2.88,1.24-1.24,2.2-2.69,2.88-4.36.68-1.66,1.02-3.48,1.02-5.45s-.34-3.76-1.02-5.44c-.68-1.68-1.64-3.14-2.88-4.38-1.24-1.24-2.69-2.21-4.34-2.9-1.65-.69-3.47-1.03-5.48-1.03s-3.8.34-5.46,1.03c-1.66.69-3.11,1.66-4.34,2.9-1.23,1.24-2.18,2.7-2.85,4.38-.68,1.68-1.02,3.49-1.02,5.44s.34,3.79,1.02,5.45c.68,1.67,1.63,3.12,2.85,4.36,1.23,1.24,2.67,2.2,4.34,2.88s3.48,1.02,5.46,1.02ZM792.46,21.35h-4.95c-.23-.82-.63-1.46-1.23-1.93s-1.33-.7-2.2-.7c-1.27,0-2.24.51-2.92,1.54-.68,1.03-1.02,2.45-1.02,4.25s.34,3.21,1.02,4.23c.68,1.02,1.65,1.53,2.92,1.53.82,0,1.53-.23,2.14-.68.61-.45,1.02-1.06,1.25-1.82h4.95c-.45,2.14-1.42,3.73-2.89,4.76-1.48,1.03-3.24,1.55-5.27,1.55-2.79,0-4.99-.85-6.6-2.56-1.61-1.71-2.41-4.04-2.41-7s.79-5.31,2.39-7.05c1.59-1.73,3.79-2.6,6.58-2.6,2.03,0,3.81.54,5.35,1.63,1.53,1.08,2.5,2.7,2.89,4.84Z" />
            </svg>
          </Link>
        </div>

        <div className="menu-toggle cursor-pointer" onClick={toggleMenu}>
          <p ref={menuOpenTextRef} className={textTone}>
            Menu
          </p>
          <p ref={menuCloseTextRef} id="menu-close">
            Close
          </p>
        </div>
      </nav>

      <div className="menu-overlay">
        <div className="menu-content">
          <div className="menu-items">
            <div className="col-lg">
              <div ref={menuPreviewImgRef} className="menu-preview-img">
                <img src="/assets/images/menu/sunset.JPG" alt="" />
              </div>
            </div>

            <div className="col-sm">
              <div className="menu-links">
                {menuLinks.map((link, i) => {
                  const isActive = pathname === link.path;

                  return (
                    <div
                      key={i}
                      className={`link ${
                        isActive ? "text-gray-500" : "text-white"
                      }`}
                      onMouseOver={() => handleLinkHover(link.prevImg)}
                      onClick={(e) => handleNavClick(e, link.path)}
                    >
                      <Link href={link.path}>{link.label}</Link>
                    </div>
                  );
                })}
              </div>

              <div className="menu-socials">
                <div className="social">
                  <a href="https://instagram.com/david_righi">Instagram</a>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  );
};

export default Menu;
